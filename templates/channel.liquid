{% assign pages = page.children_in_list | order_by: '-created_at' %}
{% assign channels = site.pages['/'].children_in_list %}

<main id="content">
  <!-- =========={ HERO }==========  -->
  {% render 'hero/hero_title', item: page %}
  
  <!-- article start -->
  <div class="relative pb-16">
    <div class="container xl:max-w-6xl mx-auto px-4">
      <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg py-10 md:py-6 lg:py-12 px-12 -mt-24">
        <div class="flex flex-wrap flex-row -mx-4 md:mt-2">
          <div class="flex-shrink w-full max-w-full lg:w-8/12">
            {% paginate_tag pages, per: 12 %}
              <!-- row -->
              <div class="flex flex-wrap flex-row justify-center -mx-4">
                {% for item in pages %}
                  <div class="flex-shrink w-full max-w-full md:w-1/2 px-3 md:px-4 lg:px-6">
                    <!-- Card -->
                    <div class="flex flex-col bg-white dark:bg-gray-800 mb-12 rounded overflow-hidden">
                      <div class="relative overflow-hidden">
                        <a href="{{ item.path }}">
                          <div class="absolute inset-0 hover:bg-black opacity-0 transition duration-700 hover:opacity-20"></div>
                          <img class="max-w-full h-auto" src="{{ item.settings.thumb_image_url | default: site.settings.default_thumb_url }}" alt="alt title">
                        </a>
                      </div>
                      <div class="pt-6 flex-1">
                        <div class="mb-2">
                          <h3 class="text-lg lg:text-xl leading-normal mb-4 text-gray-800 dark:text-gray-200"><a href="{{ item.path }}" class="hover:text-primary-700 dark:hover:text-gray-100">{{ item.link_text }}</a></h3>
                          <div class="text-gray-500">
                            <svg class="bi bi-calendar me-2 inline-block" width=".8rem" height=".8rem" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" d="M14 0H2a2 2 0 00-2 2v12a2 2 0 002 2h12a2 2 0 002-2V2a2 2 0 00-2-2zM1 3.857C1 3.384 1.448 3 2 3h12c.552 0 1 .384 1 .857v10.286c0 .473-.448.857-1 .857H2c-.552 0-1-.384-1-.857V3.857z" clip-rule="evenodd"></path>
                                <path fill-rule="evenodd" d="M6.5 7a1 1 0 100-2 1 1 0 000 2zm3 0a1 1 0 100-2 1 1 0 000 2zm3 0a1 1 0 100-2 1 1 0 000 2zm-9 3a1 1 0 100-2 1 1 0 000 2zm3 0a1 1 0 100-2 1 1 0 000 2zm3 0a1 1 0 100-2 1 1 0 000 2zm3 0a1 1 0 100-2 1 1 0 000 2zm-9 3a1 1 0 100-2 1 1 0 000 2zm3 0a1 1 0 100-2 1 1 0 000 2zm3 0a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"></path>
                              </svg><span>{{ item.published_at | date: "%Y-%m-%d" }}</span>
                          </div>
                        </div>
                        <p class="text-gray-500 line-clamp-2">{{ item.settings.description | default: item.settings.content | strip_html | truncate: 100 }}</p>
                      </div>
                    </div><!-- End card -->
                  </div>
                {% endfor %}
              </div><!-- end row -->

              <div class="text-center mt-4">
                <!-- center pagination -->
                {% render 'paginate', paginate: paginate %}
              </div>
            {% endpaginate_tag %}
          </div>

          <!-- sidebar -->
          <div class="flex-shrink w-full max-w-full lg:w-1/3 lg:ps-16">
            <aside class="sticky mt-12 lg:mt-0">
              <!-- widget -->
              <aside id="categories" class="widget mb-4">
                <h4 class="text-lg leading-normal mb-2 font-semibold text-gray-800 dark:text-gray-100"><span>快速导航</span></h4>
                <ul>
                  {% for ch in channels %}
                    <li>
                      <a class="py-2 flex justify-between items-center hover:text-primary-700 hover:bg-gray-100 dark:hover:text-gray-100" href="{{ ch.path }}">
                        {{ ch.link_text }}
                        <span class="text-sm py-1 px-2 bg-gray-50 dark:bg-gray-900 dark:bg-opacity-20 text-primary-700 dark:text-gray-200 rounded">{{ ch.pages_in_list | size }}</span>
                      </a>
                    </li>
                  {% endfor %}
                  
                </ul>
              </aside><!-- end widget -->

              <!-- widget -->
              {% if site.settings.aside_html %}
                <aside id="meta" class="widget mb-4">
                  {{ site.settings.aside_html }}
                </aside><!-- end widget -->
              {% endif %}
            </aside>          
          </div><!-- end sidebar -->
        </div>
      </div>
    </div>
  </div><!-- End Blog -->
</main>

{% schema %}
  {
    "name": "栏目-Card卡片式列表",
    "description": "卡片列表栏目模板",
    "thumb_url": "images/theme/channel-card.webp",
    "preview_image_urls": [
      "images/theme/channel-card.webp"
    ],
    "sub_page_templates": ["page"],
    "settings": [
      {
        "id": "title",
        "type": "text",
        "placeholder": "",
        "label": "t:settings_schema.page.settings.title.label",
        "info": "t:settings_schema.page.settings.title.info"
      },
      {
        "id": "description",
        "type": "textarea",
        "label": "t:settings_schema.page.settings.description.label"
      },
      {
        "id": "tags",
        "type": "tag_picker",
        "multiple": true,
        "label": "t:settings_schema.page.settings.tags.label"
      },
      {
        "id": "thumb_image_url",
        "type": "image_picker",
        "ratio": "4:1",
        "width": 640,
        "label": "t:settings_schema.page.settings.thumb_image_url.label"
      },
      {
        "id": "content",
        "type": "richtext",
        "label": "t:settings_schema.page.settings.content.label"
      }
    ]
  }
{% endschema %}
